(()=>{"use strict";let e=null,t=null;self.addEventListener("fetch",(r=>{console.log("fetch",r);const o=r.request.url;if(o.startsWith("https://coiiector.github.io/project/search/search.html")){const s=new URL(o).searchParams.get("s")?.trim()||null;null!==s&&r.respondWith(function(r){return new Promise((async function(o,s){try{await(null!==t?t:t=new Promise((function(t,r){const o=indexedDB.open("c-search",1);o.onerror=e=>{r(e)},o.onupgradeneeded=e=>{const t=e.target.result;t.createObjectStore("pairs",{keyPath:"key"}).transaction.oncomplete=e=>{t.transaction("pairs","readwrite").objectStore("pairs").add({key:"json",value:{g:{url:"https://www.google.com/search?q={ARG}"},s:{url:"https://open.spotify.com/search/{ARG}"},y:{url:"https://www.youtube.com/results?search_query={ARG}"},gt:{url:"https://translate.google.pl/?sl=auto&tl=en&text={ARG}&op=translate"}}})}},o.onsuccess=r=>{e=r.target.result,t(!0)}})));const s=await new Promise((function(t,r){const o=e.transaction(["pairs"]).objectStore("pairs").get("json");o.onerror=e=>{t(e)},o.onsuccess=e=>{t(o.result.value)}})),n=function(e,t){const r=t.indexOf(" ");let o=null,s=null;-1!==r&&(o=t.substr(0,r),o in e?s=t.substr(r).trim():o=null),null===o&&(o="g",s=t);const n=e[o];if(!n)return null;const{url:c}=n;return c.replace("{ARG}",encodeURIComponent(s))}(s,r);if(n)return console.log("redirecting...",n),void o(Response.redirect(n))}catch(e){}o(Response.redirect("https://coiiector.github.io/project/search/search.html"))}))}(s))}else if("https://coiiector.github.io/project/search/calendar"===o){const e=new Date(Date.now()-6048e5),t=`https://calendar.google.com/calendar/u/0/r/custom/3/w/${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`;r.respondWith(Response.redirect(t))}}))})();